-- Kyoto by notpaki and cyborg
-- Auto Kyoto Combo for The Strongest Battlegrounds (Hero Hunter only)
-- Use at your own risk, may violate TOS

local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local AutoKyotoButton = Instance.new("TextButton")
local PingButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")

local plr = game.Players.LocalPlayer
local chr = plr.Character or plr.CharacterAdded:Wait()
local hum = chr:WaitForChild("Humanoid")
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local UserPing = game:GetService("Stats").Network.ServerStatsItem["Data Ping"] -- Real ping

-- Define the teleport distance for dash
local teleportDistance = 18.42

-- Function to teleport the player forward
local function teleportForward()
    local forwardDirection = humanoidRootPart.CFrame.LookVector
    local newPosition = humanoidRootPart.Position + forwardDirection * teleportDistance
    humanoidRootPart.CFrame = CFrame.new(newPosition)
end

-- Function to get current ping
local function getPing()
    return UserPing:GetValue()
end

-- Function to perform the Kyoto combo
local function performKyotoCombo(target)
    if not target or not target:FindFirstChild("Humanoid") or target.Humanoid.Health <= 0 then return end
    
    local ping = getPing() / 1000 -- Convert to seconds
    local waitTime = ping + 0.05 -- Adjust based on ping
    
    -- Step 1: Dash to target
    local direction = (target.HumanoidRootPart.Position - humanoidRootPart.Position).unit
    humanoidRootPart.CFrame = CFrame.new(humanoidRootPart.Position + direction * 5)
    wait(waitTime)
    
    -- Step 2: M1 x3
    for i = 1, 3 do
        -- Simulate M1 (left click)
        game:GetService("VirtualUserService"):ClickButton1(Vector2.new(0,0))
        wait(0.2 + ping)
    end
    
    -- Step 3: Side dash
    teleportForward() -- Or side dash logic
    wait(waitTime)
    
    -- Step 4: M1 x3 again
    for i = 1, 3 do
        game:GetService("VirtualUserService"):ClickButton1(Vector2.new(0,0))
        wait(0.2 + ping)
    end
    
    -- Step 5: Uppercut (assume key Q or ability 1)
    game:GetService("VirtualInputManager"):SendKeyEvent(true, "One", false, game)
    wait(0.3 + ping)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, "One", false, game)
    
    -- Step 6: Downslam (assume key E or ability 2)
    game:GetService("VirtualInputManager"):SendKeyEvent(true, "Two", false, game)
    wait(0.3 + ping)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, "Two", false, game)
    
    -- Step 7: Lethal Whirlwind Stream (ability 3)
    game:GetService("VirtualInputManager"):SendKeyEvent(true, "Three", false, game)
    wait(0.5 + ping)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, "Three", false, game)
    
    -- Step 8: Flowing Water (ability 4)
    game:GetService("VirtualInputManager"):SendKeyEvent(true, "Four", false, game)
    wait(0.5 + ping)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, "Four", false, game)
    
    -- More steps if needed for full combo
    StatusLabel.Text = "Combo Performed!"
end

-- Find nearest target
local function getNearestTarget()
    local closest = nil
    local closestDist = math.huge
    for _, p in pairs(game.Players:GetPlayers()) do
        if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p.Character.Humanoid.Health > 0 then
            local dist = (p.Character.HumanoidRootPart.Position - humanoidRootPart.Position).magnitude
            if dist < closestDist and dist < 50 then -- Range limit
                closestDist = dist
                closest = p.Character
            end
        end
    end
    return closest
end

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- GUI Styling
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
MainFrame.Size = UDim2.new(0, 250, 0, 300)
MainFrame.Position = UDim2.new(0.5, -125, 0.5, -150)
MainFrame.Active = true
MainFrame.Draggable = true

TitleLabel.Parent = MainFrame
TitleLabel.Text = "Kyoto by notpaki and cyborg"
TitleLabel.Size = UDim2.new(1, 0, 0.2, 0)
TitleLabel.Position = UDim2.new(0, 0, 0, 0)
TitleLabel.TextScaled = true
TitleLabel.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.BorderSizePixel = 0

AutoKyotoButton.Parent = MainFrame
AutoKyotoButton.Text = "Toggle Auto Kyoto"
AutoKyotoButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
AutoKyotoButton.Size = UDim2.new(1, 0, 0.2, 0)
AutoKyotoButton.Position = UDim2.new(0, 0, 0.3, 0)
AutoKyotoButton.TextColor3 = Color3.new(1, 1, 1)

PingButton.Parent = MainFrame
PingButton.Text = "Check Ping"
PingButton.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
PingButton.Size = UDim2.new(1, 0, 0.2, 0)
PingButton.Position = UDim2.new(0, 0, 0.6, 0)
PingButton.TextColor3 = Color3.new(1, 1, 1)

StatusLabel.Parent = MainFrame
StatusLabel.Text = "Status: Ready"
StatusLabel.Size = UDim2.new(1, 0, 0.2, 0)
StatusLabel.Position = UDim2.new(0, 0, 0.8, 0)
StatusLabel.TextScaled = true
StatusLabel.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
StatusLabel.TextColor3 = Color3.new(1, 1, 1)
StatusLabel.BorderSizePixel = 0

-- Event handlers
local autoEnabled = false

AutoKyotoButton.MouseButton1Click:Connect(function()
    autoEnabled = not autoEnabled
    AutoKyotoButton.Text = autoEnabled and "Auto Kyoto: ON" or "Toggle Auto Kyoto"
    StatusLabel.Text = autoEnabled and "Auto Mode Enabled" or "Status: Ready"
end)

PingButton.MouseButton1Click:Connect(function()
    local ping = getPing()
    StatusLabel.Text = "Ping: " .. ping .. " ms"
end)

-- Main loop for auto mode
game:GetService("RunService").Heartbeat:Connect(function()
    if autoEnabled then
        local target = getNearestTarget()
        if target then
            performKyotoCombo(target)
            wait(1) -- Cooldown between combos
        end
    end
end)

-- Character respawn handler
plr.CharacterAdded:Connect(function(newChar)
    character = newChar
    humanoidRootPart = newChar:WaitForChild("HumanoidRootPart")
    hum = newChar:WaitForChild("Humanoid")
end)
